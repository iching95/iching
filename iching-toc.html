<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TOC Viewer</title>
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
        }
    
        th, td {
            border: 1px solid black;
            padding: 8px;
            text-align: left;
        }
    
        .hexagram-index,
        .chinese-name {
            width: 7.5%;
        }
    
        .book-name,
        .page {
            width: 42.5%;
        }
    
        .unit {
            display: flex;
            flex-wrap: wrap;
        }
    </style>    
</head>

<body>

    <h2>Table of Contents</h2>
    <div id="tocBody" class="unit"></div>


    <script>
window.onload = function() {
        // Set this variable to change the number of units per row
        const unitsPerRow = 4;

        fetch('data.txt')
        .then(response => response.json())
        .then(hexagrams => {
            fetch('pages.txt')
            .then(response => response.json())
            .then(pages => {
                let tocBody = document.getElementById('tocBody');
                
                for (let hexIndex = 1; hexIndex <= 64; hexIndex++) {
                    // Create the unit container
                    let unit = document.createElement('div');
                    unit.style.width = (100 / unitsPerRow) + '%';
                    unit.className = "unit";
                    
                    let hexChineseName = hexagrams[hexIndex.toString()] ? hexagrams[hexIndex.toString()]["c"] : "";

                    unit.innerHTML = `<strong>${hexIndex}. ${hexChineseName}</strong><br>`;
                    
                    for (let book in pages) {
                        const page = pages[book].page[hexIndex - 1] + pages[book].offset - pages[book].page[0];
                        unit.innerHTML += `${book}: ${page}<br>`;
                    }

                    tocBody.appendChild(unit);
                }

            })
            .catch(error => {
                console.error('There was an error!', error);
            });
        })
        .catch(error => {
            console.error('There was an error reading hexagrams!', error);
        });
    }
    </script>

</body>
</html>
