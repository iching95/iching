<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
	<script>
	var dic = ["https://humanum.arts.cuhk.edu.hk/Lexis/lexi-mf/search.php?word=","https://ctext.org/dictionary.pl?if=gb&char="]
	document.onclick = (evt) => {
		const sel = getSelection();

		  if (sel.rangeCount) {
		    const range = sel.getRangeAt(0);
		    const targetedNode = range.startContainer;
		    const clickedLetter = targetedNode.textContent.substr(range.startOffset, 1);
		    document.getElementById("dic").innerHTML = clickedLetter
		    document.getElementById("dic-btn").onclick = function(e){
			    location.href = dic[0] + encodeURIComponent(clickedLetter)
		    }
		    document.getElementById("dic-btn2").onclick = function(e){
			    location.href = dic[1] + encodeURIComponent(clickedLetter)
		    }
		  }
	};
	</script>
	<style>
	body {
		background-color: #000;
		color: #fff;
        	font-family: monospace;
	}
	.np {
		display:block;
		margin: 24px 0px;
	}
	button{
	    margin: 12px 0px 12px;
	    width: 100%;
	    padding: 7.5%;
	    font-size: 200%;
	    text-transform: uppercase;
	}
	 .stmt{
	    font-size:24px;
	    }
	  .symbol, .number{
	    font-size:64px;
		  display:inline;
		  padding:6px 12px;
	   }
	   .number{
	    	position: relative;
    		top: -0px;
	   }
	    .header{
		    width:100%;
		    text-align:center;
	    }
	</style>
  </head>
<body>
<div id="content"/>

  <script>
  var nameMap = ["qian","kun","zhun","meng","xu","song","shi","bi","xiao-xu","lu","tai","pi","tong-ren","da-you","qian1","yu","sui","gu","lin","guan","shi-he","bi1","bo","fu","wu-wang","da-xu","yi","da-guo","kan","li","xian","heng","dun","da-zhuang","jin","ming-yi","jia-ren","kui","jian","jie","sun","yi1","guai","gou","cui","sheng","kun1","jing","ge","ding","zhen","gen","jian1","gui-mei","feng","lu1","xun","dui","huan","jie1","zhong-fu","xiao-guo","ji-ji","wei-ji"]
  
  var name = window.location.search?window.location.search.replace("?",""):"qian";
  name = parseInt(name)>0?nameMap[name-1]:name
  name = name?name:"qian";

  // console.log(name)
  var idx = nameMap.indexOf(name);
	  
  var insertHTML = "<div class='header'><div class='number'>"+((1+idx))+"</div><div class='symbol'>"+(String.fromCharCode(19904+idx))+"</div></div>"

	var next = "location.href='./read.html?"+nameMap[idx+1]+"'";
	var prev = "location.href='./read.html?"+nameMap[idx-1]+"'";
	var home = "location.href='./'";

	var footerHTML = "";
	footerHTML += (idx>=64?"":('<button onclick="'+next+'" type="button">next</button>'))
	footerHTML += (idx<=0?" ":('<button onclick="'+prev+'" type="button">prev</button>'))
	footerHTML += ('<button onclick="'+home+'" type="button">home</button>')
	footerHTML += ('<button id="dic-btn" type="button">lookup(<span id="dic"></span>)</button>')
	footerHTML += ('<button id="dic-btn2" type="button">lookup(<span id="dic"></span>)</button>')

	  fetch('content/'+name+'.txt')
	    .then(response => response.text())
	    .then((data) => {
	      var content = data.split(/\r?\n/)
	      content.map(stmt => {
		stmt = stmt.replace("#np","<span class='np'/>")
		insertHTML = insertHTML + ("<div class='stmt'>" + stmt + "</div>");
	      })
	      document.getElementById("content").innerHTML = insertHTML + footerHTML
	    })
	  
	document.write(insertHTML)
	document.write("Loading "+name + " ...")	  
	</script>

</body>
</html>
